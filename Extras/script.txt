CREATE TABLE actividades (
    codactividad serial,
    nombre character varying(100) NOT NULL,
    descripcion text NOT NULL,
    responsable character varying(100) NOT NULL,
    valoracion integer,
    coddocente integer,
    codtipo integer
);

CREATE TABLE clases (
    codclase serial,
    dia integer NOT NULL,
    nombre character varying(100) NOT NULL,
    codjornada integer,
    coddocente integer
);

CREATE TABLE convenciones (
    codconvencion serial,
    nombre character varying(50) NOT NULL,
    color character varying(45) NOT NULL,
    codclase integer
);

CREATE TABLE docentes (
    cedula integer NOT NULL,
    apellidos character varying(100) NOT NULL,
    nombres character varying(100) NOT NULL,
    codigo character varying(50),
    facultad integer,
    unidadacademica integer,
    semestre integer NOT NULL,
    formacion text,
    direccion character varying(100),
    telefono character varying(50),
    correo character varying(100)
);

CREATE TABLE evaluaciones (
    codeva serial,
    coddoc integer,
    codprod integer,
    calificacion integer NOT NULL
);

CREATE TABLE fechaseguimientos (
    codfechseg serial,
    fechainicio date NOT NULL,
    fechafin date NOT NULL,
    codact integer
);

CREATE TABLE horas (
    codhora serial,
    hora character varying(45) NOT NULL
);

CREATE TABLE jornadas (
    codjornada serial,
    nombre character varying(100) NOT NULL,
    codhora integer
);

CREATE TABLE productos (
    codproducto serial,
    descripcion character varying(100) NOT NULL,
    fechacompromiso date NOT NULL,
    fechaentrega date NOT NULL,
    comentarios text,
    codact integer
);


CREATE TABLE tipomodalidades (
    codtipo serial,
    nombre character varying(100) NOT NULL
);

ALTER TABLE ONLY tipomodalidades
    ADD CONSTRAINT pf_tipo PRIMARY KEY (codtipo);

ALTER TABLE ONLY actividades
    ADD CONSTRAINT pk_act PRIMARY KEY (codactividad);

ALTER TABLE ONLY clases
    ADD CONSTRAINT pk_clase PRIMARY KEY (codclase);

ALTER TABLE ONLY fechaseguimientos
    ADD CONSTRAINT pk_codfe PRIMARY KEY (codfechseg);

ALTER TABLE ONLY convenciones
    ADD CONSTRAINT pk_conven PRIMARY KEY (codconvencion);

ALTER TABLE ONLY docentes
    ADD CONSTRAINT pk_docentes PRIMARY KEY (cedula);

ALTER TABLE ONLY evaluaciones
    ADD CONSTRAINT pk_eva PRIMARY KEY (codeva);

ALTER TABLE ONLY horas
    ADD CONSTRAINT pk_hora PRIMARY KEY (codhora);

ALTER TABLE ONLY jornadas
    ADD CONSTRAINT pk_jornada PRIMARY KEY (codjornada);

ALTER TABLE ONLY productos
    ADD CONSTRAINT pk_prod PRIMARY KEY (codproducto);

CREATE INDEX fki_fechasseg_actividad ON fechaseguimientos USING btree (codact);

ALTER TABLE ONLY actividades
    ADD CONSTRAINT actividades_coddocente_fkey FOREIGN KEY (coddocente) REFERENCES docentes(cedula) ON DELETE CASCADE;

ALTER TABLE ONLY actividades
    ADD CONSTRAINT actividades_codtipo_fkey FOREIGN KEY (codtipo) REFERENCES tipomodalidades(codtipo) ON DELETE CASCADE;

ALTER TABLE ONLY clases
    ADD CONSTRAINT clases_coddocente_fkey FOREIGN KEY (coddocente) REFERENCES docentes(cedula);

ALTER TABLE ONLY clases
    ADD CONSTRAINT clases_codjornada_fkey FOREIGN KEY (codjornada) REFERENCES jornadas(codjornada);

ALTER TABLE ONLY convenciones
    ADD CONSTRAINT convencion_codclase_fkey FOREIGN KEY (codclase) REFERENCES clases(codclase);

ALTER TABLE ONLY evaluaciones
    ADD CONSTRAINT evaluacion_coddoc_fkey FOREIGN KEY (coddoc) REFERENCES docentes(cedula);

ALTER TABLE ONLY evaluaciones
    ADD CONSTRAINT evaluacion_codprod_fkey FOREIGN KEY (codprod) REFERENCES productos(codproducto);

ALTER TABLE ONLY fechaseguimientos
    ADD CONSTRAINT fk_fechasseg_actividad FOREIGN KEY (codact) REFERENCES actividades(codactividad);

ALTER TABLE ONLY jornadas
    ADD CONSTRAINT jornada_codhora_fkey FOREIGN KEY (codhora) REFERENCES horas(codhora) ON UPDATE CASCADE ON DELETE CASCADE;

ALTER TABLE ONLY productos
    ADD CONSTRAINT productos_codact_fkey FOREIGN KEY (codact) REFERENCES actividades(codactividad) ON UPDATE CASCADE ON DELETE CASCADE;

